steps:
- name: 'gcr.io/cloud-builders/mvn'
  args: ['clean']
- name: 'gcr.io/cloud-builders/mvn'
  args: ['package']
- name: 'gcr.io/cloud-builders/docker'
  args: ['build', '-t', 'aaa2:v1', 'docker/']
- name: 'gcr.io/cloud-builders/docker'
  args: ['tag', 'aaa2:v1', 'gcr.io/studyenv4/hello4:v1']
- name: 'gcr.io/cloud-builders/docker'
  args: ['push', 'gcr.io/studyenv4/hello4:v1']
# 아래는 안쓰는 거
#- name: 'gcr.io/cloud-builders/docker'
#  args: ['run', '-d', '-p', '8090:8080', 'gcr.io/studyenv4/hello4:v1']
#- name: 'gcr.io/cloud-builders/kubectl'
#  args: ['cluster-info']
#  env: ["CLOUDSDK_COMPUTE_ZONE=asia-northeast1-a","CLOUDSDK_CONTAINER_CLUSTER=studyenv4-cluster" ]
- name: 'gcr.io/cloud-builders/kubectl'
  args: ['delete', 'service', 'studyimg-service']
  env: ["CLOUDSDK_COMPUTE_ZONE=asia-northeast1-a","CLOUDSDK_CONTAINER_CLUSTER=studyenv4-cluster" ]
- name: 'gcr.io/cloud-builders/kubectl'
  args: ['delete', 'deploy', 'studyimg-node']
  env: ["CLOUDSDK_COMPUTE_ZONE=asia-northeast1-a","CLOUDSDK_CONTAINER_CLUSTER=studyenv4-cluster" ]
- name: 'gcr.io/cloud-builders/kubectl'
  args: ['create', '-f', 'k8s/deploy.yaml']
  env: ["CLOUDSDK_COMPUTE_ZONE=asia-northeast1-a","CLOUDSDK_CONTAINER_CLUSTER=studyenv4-cluster" ]
- name: 'gcr.io/cloud-builders/kubectl'
  args: ['create', '-f', 'k8s/service.yaml']
  env: ["CLOUDSDK_COMPUTE_ZONE=asia-northeast1-a","CLOUDSDK_CONTAINER_CLUSTER=studyenv4-cluster" ]